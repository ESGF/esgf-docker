{{- define "esgf.slcs.runtime-settings" -}}
HOSTNAME: {{ .Values.hostname | quote }}
DATABASES:
  # Use the same database configuration for both databases
  default: &db
    ENGINE: django.db.backends.postgresql
    HOST: {{ include "esgf.database.host" . | quote }}
    PORT: {{ include "esgf.database.port" . | quote }}
    USER: {{ include "esgf.database.user" . | quote }}
    PASSWORD: {{ include "esgf.database.password" . | quote }}
    NAME: {{ include "esgf.database.dbname" . | quote }}
  userdb: *db
{{- end -}}
{{- if .Values.slcs.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "esgf.component.fullname" (list . "slcs") }}
  labels: {{ include "esgf.component.labels" (list . "slcs") | nindent 4 }}
type: Opaque
data:
  # Inject the runtime settings ahead of the app settings, which are 10-
  05-runtime-settings.yaml: |
    {{ include "esgf.slcs.runtime-settings" . | b64enc | indent 4 | trim }}
{{- end }}
